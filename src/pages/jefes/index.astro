---
import Layout from "@/layouts/Layout.astro"
import "../../styles/global.css"

import SectionHeader from "@/components/SectionHeader.astro"
import EntriesGrid from "@/components/EntriesGrid.astro"
import CategoryToolbar from "@/components/CategoryToolbar.astro"
import Background from "@/components/Background.astro"

import { getCollection } from "astro:content"

const docs = await getCollection("jefes")
const items = docs
  .sort((a, b) => a.data.order - b.data.order)
  .map(({ data, slug, collection }) => ({
    href: `/${collection}/${slug}`,
    title: data.title,
    excerpt: data.excerpt || "",
    cover: data.cover?.src || "",
    tags: data.tags || [],
  }))

const tagSet = new Set<string>()
items.forEach((i) => (i.tags || []).forEach((t) => tagSet.add(t)))
const tags = Array.from(tagSet)
---

<Layout title="Jefes — Pharloom Archives">
  <Background />

  <SectionHeader
    title="Jefes"
    description="Encuentros principales de Pharloom. Guías de estrategia, patrones y recompensas."
  />

  <CategoryToolbar
    targetId="grid-jefes"
    tags={tags}
    placeholder="Buscar jefe…"
  />

  <EntriesGrid items={items} />
</Layout>
